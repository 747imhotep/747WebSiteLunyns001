<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title> RESULTS </title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="CSS/DraftSearch.css">
        <link rel="stylesheet" href="index/index css/Search.css">
        <link rel="icon" href="IMAGES/Favicon/Favicon-01.svg">
    </head>






    <body class="p-4" style="background-image: url(IMAGES/imgSEARCH/DeepSearch03.jpg);">
        <div class="container">
            <h1 class="mb-4" style="color: #aa0000;">Search Results</h1>

            <!-- ✅ Search Input UI -->
            <div class="input-group mb-3">
                <input type="text" class="form-control" id="search" placeholder="Search..." />
                <button class="btn btn-primary" onclick="handleSearch()">Search</button>
            </div>

            <!-- ✅ Placeholder for displaying search results or messages -->
            <div id="search-output" class="mt-3" style="color: #aa0000;"></div>
        </div>



        <!-- Fuse.js -->
            <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
        
        <!-- your search logic -->
            <script src="js/searchHandler.js"></script>

        <!-- Handle query from URL on page load -->
            <script>
                window.onload = function () {
                const params = new URLSearchParams(window.location.search);
                const query = params.get("query");
                const input = document.getElementById("search");
                const output = document.getElementById("search-output");

                if (query && input) {
                    input.value = query;

                    // Run fuzzy search logic locally and show fallback output
                    const results = fuse.search(query);
                    if (results.length > 0) {
                    const bestMatch = results[0];
                    if (bestMatch.score < 0.3) {
                        window.location.href = bestMatch.item.path;
                        return;
                    }

                    output.innerHTML = `
                        <p>No exact match found. Did you mean:</p>
                        <ul>
                        ${results.map(r => `<li><a href="${r.item.path}">${r.item.keyword}</a></li>`).join("")}
                        </ul>
                    `;
                    } else {
                    output.innerHTML = `<p>No results found for "<strong>${query}</strong>".</p>`;
                    }
                }
                };
        </script>
    </body>
</html>