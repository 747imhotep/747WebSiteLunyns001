<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Download</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="/DOWNLERCSS/downloader.css">
  <link  rel="icon" href="/IMAGEDO/Favicon/Favicon-01.png">
  <link rel="stylesheet" href="/DOWNLERCSS/requestForm.css">
</head>


  <body>
    <h2 class="officer">Secure Document Download</h2>

    <div id="emailPrompt" class="email-form">
      <p style="font-weight: 600;">Please enter your email to verify your identity:</p>
      <input type="email" id="email" placeholder="you@example.com" required>
      <button onclick="verifyEmail()">Check</button>
    </div>
    <div id="emailError" class="error-message hidden"></div>
    
<!-- Contact form (hidden by default) -->
    <div id="contactForm" class="hidden">
  <h3>Contact Us for Access</h3>
  <p>Please fill in the form below to request the document you need.</p>

  
<!-- Use your email address here -->
      <form id="requestForm" action="https://formsubmit.co/contact@lunyns.com" method="POST">

        <label for="requestName">Your Name:</label>
        <input type="text" id="requestName" name="name" required>

        <label for="requestEmail">Your Email:</label>
        <input type="email" id="requestEmail" name="email" required>

        <label for="subject">Subject:</label>
        <input type="text" id="subject" name="subject" value="Authorization Request" readonly required>

        <label for="message">Message:</label>
        <textarea id="message" name="message" rows="4" required></textarea>

  <!-- Formsubmit anti-spam honeypot -->
        <input type="text" name="_honey" style="display:none">

  <!-- Disable CAPTCHA -->
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_template" value="box">
        <input type="hidden" name="_subject" value="New submission!">
        <input type="hidden" name="_blacklist,scammer" value="spammy pattern, banned term, phrase">
        <input type="text" name="_honey" style="position:absolute;left:-9999px;">
        

  <!-- Redirect after submission (optional) -->
        <input type="hidden" name="_next" value="https://lunyns.com/Thanks/Thanks.html">

        <button type="submit">Request Access</button>
      </form>
    </div>
<!-- Contact form END) -->


<!-- Instructions block -->
    <div id="downloadInstructions arrowIndicator" class="informer">
      <h2>üßæ Welcome to the Secure Document Download Portal</h2>
      <h3>Instructions:</h3>
        <p>This page provides access to sensitive business documents, 
          including SCOs, FCOs, ICPOs, CIs, and more.
        Access is restricted to users with <b>an authorized email address</b>. 
        If your email is on our approved list, you'll be able to securely 
        download the documents relevant to your inquiry.
        If you encounter any issues or need assistance, 
        please contact our support team.
        Thank you for your cooperation.
        Your security is our priority.</p>
    </div>



<!-- Arrow indicator -->
    <div id="arrowIndicator" class="arrow-indicator">‚¨áÔ∏è</div>

    <div id="downloadInstructions" class="hidden">
      <div class="confirmation" id="confirmation"></div>
      <p id="confirmation" class="hidden" style="color: green; border: 1.5px solid rgb(1, 70, 1); margin-top: 20px;"></p>
    </div>

<!-- Return button -->
   <div>
  <button id="returnHomeBtn" class="download-btn hidden" onclick="window.location.href='/index.html'">
    Return to HOME
  </button>
  </div>




    <section id="downloadswrapper" class="downloadDocuments download-highlight">
    <div class="download-item hidden">
      <img src="/IMAGEDO/DownloadFlag/Doc1.png" alt="Download Document" class="download-image">
      <p class="download-text">Click the button below to download your document.</p>
      <button class="download-btn" onclick="downloadDoc('PRICE LIST 2 Refineries To 30 Dec 2025.pdf')"><i class="fas fa-file-download"></i> 1. PRICE LIST - PETROLEUM</button>
    </div>

    <div class="download-item hidden">
      <img src="/IMAGEDO/DownloadFlag/Doc2.png" alt="Download Document" class="download-image">
      <p class="download-text">Click the button below to download your document.</p>
      <button class="download-btn" onclick="downloadDoc('F-05.7 NO NEGOT TTT- TTV- TTO- - PROCEDURE 2025.pdf')"><i class="fas fa-file-download"></i> 2. PETROLEUM SCO</button>
    </div>

    <div class="download-item hidden">
      <img src="/IMAGEDO/DownloadFlag/Doc3.png" alt="Download Document" class="download-image">
      <p class="download-text">Click the button below to download your document.</p>
      <button class="download-btn" onclick="downloadDoc('[B00.000] NCNDA 25082701.docx')"><i class="fas fa-file-download"></i> 3. NCNDA</button>
    </div>

    <div class="download-item hidden">
      <img src="/IMAGEDO/DownloadFlag/Doc4.png" alt="Download Document" class="download-image">
      <p class="download-text">Click the button below to download your document.</p>
      <button class="download-btn" onclick="downloadDoc('[B00.000] EN590  IMPFA 25082701.docx')"><i class="fas fa-file-download"></i> 4. IMPFA</button>
    </div>
  </section>

  <div class="download-item hidden">
      <img src="/IMAGEDO/DownloadFlag/Doc5.png" alt="Download Document" class="download-image">
      <p class="download-text">Click the button below to download your document.</p>
      <button class="download-btn" onclick="downloadDoc('Empty Document.jpg')"><i class="fas fa-file-download"></i> 5. NOT AVAILABLE</button>
    </div>
  </section>

      
<!-- ALERT MESSAGE START -->
      <div id="customAlert" class="hidden">
        <div class="alert-box">
          <p id="alertMessage"></p>
          <button onclick="closeCustomAlert()">OK</button>
        </div>
      </div>
<!-- ALERT MESSAGE END -->
  


    



    
<!------------------------------------------------------------------------------------------------>
    <script>
      console.log("Script loaded!");  // ‚úÖ Debug line

      let verifiedEmail = '';
      let lastDownloadTime = 0;
      const downloadCooldown = 10000; // 10 seconds


// VERIFY EMAIL
      function verifyEmail() {
        const emailInput = document.getElementById("email");
        const email = emailInput.value.trim().toLowerCase();
        const errorBox = document.getElementById("emailError");

        // Validate email
        if (!email || !validateEmail(email)) {
          console.log("Invalid email format!");
          errorBox.textContent = "‚ö†Ô∏è Please enter a valid email.";
          errorBox.classList.remove("hidden");
          return;
        } else {
          console.log("Email is valid.");
          errorBox.classList.add("hidden");
        }

        // Check if email is authorize
        if (!authorizedEmails.includes(email)) {
        // üëá This replaces the browser alert
          showCustomAlert("Please contact us to obtain authorization to download a specific document.");
          
          const form = document.getElementById("contactForm");
          form.classList.remove("hidden");
          form.classList.add("visible", "form-reveal"); // Add animation/styling class
          
          document.getElementById("requestEmail").value = email; //auto-fill
          return
        }

      function showCustomAlert(message) {
          document.getElementById("alertMessage").textContent = message;
          document.getElementById("customAlert").classList.remove("hidden");
          }

          function closeCustomAlert() {
          document.getElementById("customAlert").classList.add("hidden");
      }


        // ‚úÖ Email is authorized
        verifiedEmail = email;

        // Save email
        verifiedEmail = email;
        console.log("Verified email set to:", verifiedEmail);

        // Show download area
        document.getElementById("emailPrompt").classList.add("hidden");
        document.getElementById("downloadInstructions").classList.remove("hidden");

        document.querySelectorAll('.download-item').forEach(el => {
          el.classList.remove('hidden');
          el.classList.add('show');
        });

        // Animate box
        const wrapper = document.getElementById("downloadswrapper");
        wrapper.classList.remove("download-highlight");
        void wrapper.offsetWidth; // Force reflow
        wrapper.classList.add("download-verified");

        // Scroll and show arrow
        const arrow = document.getElementById("arrowIndicator");
        arrow.classList.remove("hidden");
        wrapper.scrollIntoView({ behavior: 'smooth'});

        // Hide arrow & instruction after timeout
        setTimeout(() => {
          arrow.classList.add("hidden");
          document.getElementById("downloadInstructions").classList.add("hidden");
        }, 5000);
      }

// VALIDATE EMAIL
      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

// DOWNLOAD DOC
      function downloadDoc(fileName) {
        const now = Date.now();
        if (now - lastDownloadTime < downloadCooldown) {
          alert("‚è≥ Please wait a few seconds before downloading again.");
          return;
        }

        if (!verifiedEmail) {
          alert("Please verify your email before downloading.");
          return;
        }

        triggerDownload(fileName); // ‚úÖ Call it
      } 

// TRIGGER DOWNLOAD
        function triggerDownload(fileName) {
          const now = new Date();
          lastDownloadTime = Date.now();

        if (!verifiedEmail){
          console.error("Verified email is not set.");
          return;
        }

          const sanitizedEmail = verifiedEmail.replace(/[^a-z0-9]/gi, '_').toLowerCase();
          const dynamicName = `Document_${sanitizedEmail}_${fileName}`;

          const downloadLink = document.createElement("a");
          downloadLink.href = `./DownloadDoc/${fileName}`;
          downloadLink.download = dynamicName;
          document.body.appendChild(downloadLink);
          downloadLink.click();
          document.body.removeChild(downloadLink);

          const confirmation = document.getElementById("confirmation");
          confirmation.textContent = `‚úÖ ${dynamicName} has been downloaded.`;
          confirmation.classList.remove("hidden");
          confirmation.classList.add("show");

          document.getElementById("returnHomeBtn").classList.remove("hidden");

          setTimeout(() => {
            confirmation.classList.add("hidden");
          }, 5000);

          document.getElementById("downloadswrapper").classList.remove("download-highlight");
        }


      // For better security, you‚Äôll want to replace this later 
      // with a server-side check (e.g., via API or database).
        const authorizedEmails = [
          "user1@example.com",
          "paul@example.com",
          "trusted.person@yourdomain.com",
          "manager@company.org",
          "support@lunyns.com",
          "lunywholesaler@yahoo.com",
          "soundiata@lunyns.com",
          "contact@lunyns.com",
          "sonia.nyimi@gmail.com"
        ];

        document.addEventListener("DOMContentLoaded", function () {
        function showCustomAlert(message) {
        document.getElementById("alertMessage").textContent = message;
        document.getElementById("customAlert").classList.remove("hidden");
        }

        function closeCustomAlert() {
        document.getElementById("customAlert").classList.add("hidden");
        }

        // Expose function to global scope so the button can find it
        window.showCustomAlert = showCustomAlert;
        window.closeCustomAlert = closeCustomAlert;
        });
    </script>
  </body>
</html>
